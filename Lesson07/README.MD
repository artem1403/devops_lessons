# Тренировка docker-compose

Поднять 2 сервиса, сборочный и продовый.
В сборочном сервисе должна происходить сборка Java приложения. В продовом - запуск приложения. Продовый образ должен быть минимальным по размеру.

# TODO
* [x] Вытащить boxfuse как папку submodule. Ссылка https://github.com/boxfuse/boxfuse-sample-java-war-hello.git
* [x] Добить мавен, чтобы поднимался контейнер, без сборки
* [x] Сделать в мавене volume чтобы контейнер мог собирать приложения из него
* [x] Разобраться, как в контейнере maven сделать volume именованным
* [x] Собрать продовский контейнер с легковесным томкатом


# Проблемы архитектуры
1. Самое важное, что путь к исходникам зашит в [Dockerfile](maven/Dockerfile). То есть, если использовать такой же подход в промышленной эксплуатации, то нужен отдельный человек, который будет сидеть и только переписывать этот докерфайл, меняя в нем путь к приложению, которое нужно забилдить и выложить на прод.
2. Мне кажется должен быть способ передачи папки с исходниками командой непосредственно в [docker-compose.yml](docker-compose.yml). Если он есть, то можно обойтись без докерфайла и папки maven.
3. Судя по логам выполнения docker-compose, сборку мавеном он запустил два раза, первый раз удачно, а второй - нет. Надо разобраться почему так и выключить лишнюю сборку.


## Памятка по командам
### Docker
```
docker volume ls
docker volume rm _name
docker-compose up --build
docker-compose down
```

### Git submodules
Добавление подмодуля
```bash
git submodule add https://github.com/boxfuse/boxfuse-sample-java-war-hello.git
```
При клонировании проекта с подмодулем делаем следующее
```bash
git submodule init
git submodule update
```
